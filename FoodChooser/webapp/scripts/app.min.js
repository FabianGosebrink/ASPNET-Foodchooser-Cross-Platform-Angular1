var app;!function(t){var o=angular.module("FoodChooserApp",["homeModule","listsModule","accountModule","commonModule","useravatar"]).constant("appSettings",{serverPath:"https://newfoodchooser.azurewebsites.net/"});o.config(["$httpProvider",function(t){t.interceptors.push("httpAuthInterceptor"),t.defaults.headers.get||(t.defaults.headers.get={}),t.defaults.headers.common["Cache-Control"]="no-cache",t.defaults.headers.common.Pragma="no-cache",t.defaults.headers.common["If-Modified-Since"]="0"}])}(app||(app={}));var app;!function(t){var o;!function(t){angular.module("accountModule",["ui.router"])}(o=t.account||(t.account={}))}(app||(app={}));var app;!function(t){var o;!function(t){function o(t,o){o.otherwise("/"),t.state("login",{url:"/login",templateUrl:"src/account/templates/login.html",controller:"account.controllers.accountController",controllerAs:"vm"}).state("register",{url:"/register",templateUrl:"src/account/templates/register.html",controller:"account.controllers.accountController",controllerAs:"vm"})}var e=angular.module("accountModule");e.config(o),o.$inject=["$stateProvider","$urlRouterProvider"]}(o=t.home||(t.home={}))}(app||(app={}));var app;!function(t){var o;!function(t){angular.module("commonModule",[])}(o=t.common||(t.common={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e){this.currentUser=t,this.storageService=o,this.$location=e,console.log(this.currentUser.isLoggedIn())}return t.prototype.IsLoggedIn=function(){return this.currentUser.isLoggedIn()},t.prototype.LogOut=function(){this.storageService.DeleteAuthObject(),console.log("logged out"),this.$location.path("/")},t.$inject=["currentUser","myStorageService","$location"],t}();angular.module("homeModule").controller("navigationController",o)}(o=t.home||(t.home={}))}(app||(app={}));var app;!function(t){var o;!function(t){angular.module("homeModule",["ui.router"])}(o=t.home||(t.home={}))}(app||(app={}));var app;!function(t){var o;!function(t){function o(t,o){o.otherwise("/"),t.state("home",{url:"/",controller:"home.controllers.homeController",controllerAs:"vm",templateUrl:"src/home/Templates/overview.html"}).state("about",{url:"/about",templateUrl:"src/home/Templates/about.html"})}var e=angular.module("homeModule");e.config(o),o.$inject=["$stateProvider","$urlRouterProvider"]}(o=t.home||(t.home={}))}(app||(app={}));var app;!function(t){var o;!function(t){angular.module("listsModule",["ui.router"])}(o=t.lists||(t.lists={}))}(app||(app={}));var app;!function(t){var o;!function(t){function o(t,o){o.otherwise("/"),t.state("lists",{url:"/lists",templateUrl:"src/lists/Templates/lists.html",controller:"lists.controllers.listController",controllerAs:"vm"}).state("listDetails",{url:"/lists/:id",templateUrl:"src/lists/Templates/details.html",controller:"lists.controllers.listDetailsController",controllerAs:"vm"})}var e=angular.module("listsModule");e.config(o),o.$inject=["$stateProvider","$urlRouterProvider"]}(o=t.lists||(t.lists={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e,n,r){this.Id=t,this.ItemName=o,this.FoodListId=e,this.Avatar=n,this.IsPublic=r}return t}();t.FoodItem=o}(o=t.models||(t.models={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e,n){this.Id=t,this.Name=o,this.UserId=e,this.FoodItems=n}return t}();t.FoodList=o}(o=t.models||(t.models={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o){this.Username=t,this.Password=o}return t}();t.LoginUser=o}(o=t.models||(t.models={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e,n){this.Username=t,this.Email=o,this.Password=e,this.ConfirmPassword=n}return t}();t.RegisterUser=o}(o=t.models||(t.models={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e){this.UserId=t,this.UserName=o,this.Email=e}return t}();t.User=o}(o=t.models||(t.models={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e){var n=this;this.authenticationService=t,this.storageService=o,this.$location=e,this.doLoginUser=function(){n.working=!0,n.authenticationService.loginUser(n.loginUser.Username,n.loginUser.Password).then(function(t){n.storageService.SetAuthObject(t),n.$location.path("/")},function(t){n.handleError(t)})["finally"](function(){n.working=!1})},this.register=function(){n.working=!0,n.authenticationService.registerUser(n.registerUser.Username,n.registerUser.Email,n.registerUser.Password,n.registerUser.ConfirmPassword).then(function(t){n.successMessage="You have been registered. Please login."},function(t){n.handleError(t)})["finally"](function(){n.working=!1})},this.handleError=function(t){if(t.data.error_description&&(n.errorMessage=t.data.error_description+"\r\n"),t.Message&&(n.errorMessage=t.Message+"\r\n"),t.ModelState){var o;for(var e in t.ModelState)for(var r=0;r<t.ModelState[e].length;r++)o.push(t.ModelState[e][r]),n.errorMessage+=t.ModelState[e][r]+"\r\n"}},this.resetMessages=function(){n.errorMessage="",n.successMessage=""}}return t.$inject=["authenticationService","myStorageService","$location"],t}();angular.module("accountModule").controller("account.controllers.accountController",o)}(o=t.account||(t.account={}))}(app||(app={}));var app;!function(t){var o;!function(t){"use strict";var o=function(){function t(t,o){var e=this;this.$http=t,this.appSettings=o,this.loginUser=function(t,o){return e.$http({method:"POST",url:e.actionUrl+"Token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:"grant_type=password&username="+encodeURIComponent(t)+"&password="+encodeURIComponent(o)})},this.registerUser=function(t,o,n,r){var i={Email:o,Username:t,Password:n,ConfirmPassword:r};return e.$http.post(e.actionUrl+"api/account/register",i)},this.actionUrl=this.appSettings.serverPath}return t.$inject=["$http","appSettings"],t}();angular.module("accountModule").service("authenticationService",o)}(o=t.account||(t.account={}))}(app||(app={}));var app;!function(t){var o;!function(o){var e=function(){function o(t){this.storageService=t}return o.prototype.isLoggedIn=function(){var t=this.storageService.GetStoredData();return null!=t},o.prototype.getUser=function(){var o=this.storageService.GetStoredData();if(!o)return null;var e=new t.models.User(o.userName,o.userName,o.email);return e},o.$inject=["myStorageService"],o}();angular.module("commonModule").service("currentUser",e)}(o=t.common||(t.common={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e){var n=this;this.$q=t,this.storageService=o,this.$location=e,this.request=function(t){t.headers=t.headers||{};var o=n.storageService.GetToken();return o&&(t.headers.Authorization="Bearer "+o),t},this.responseError=function(t){return 401!==t.status&&403!==t.status||(n.storageService.DeleteAuthObject(),n.$location.path("/login")),n.$q.reject(t)},this.storageService=o,this.$q=t}return t.$inject=["$q","myStorageService","$location"],t}();t.HttpAuthInterceptor=o,angular.module("commonModule").service("httpAuthInterceptor",o)}(o=t.common||(t.common={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(){}return t.prototype.SetAuthObject=function(t){localStorage.setItem("auth",JSON.stringify(t))},t.prototype.DeleteAuthObject=function(){localStorage.removeItem("auth")},t.prototype.GetToken=function(){var t=localStorage.getItem("auth");if(t){var o=JSON.parse(t);if(o&&o.data)return o.data.access_token}return null},t.prototype.GetStoredData=function(){var t=localStorage.getItem("auth");return t?t:null},t.$inject=[],t}();angular.module("commonModule").service("myStorageService",o)}(o=t.common||(t.common={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o){var e=this;this.foodDataService=t,this.window=o,setTimeout(function(){return e.getRandomFood()},1e3)}return t.prototype.getRandomFood=function(){var t=this;this.ErrorMessage=null,this.RandomFood=null,this.foodDataService.GetRandomFood().success(function(o){t.RandomFood=o}).error(function(o){t.ErrorMessage="No food found :-("})},t.prototype.getRecipesWithGoogle=function(){window.open("https://www.google.de/search?q="+this.RandomFood.ItemName,"_blank")},t.prototype.getRecipesWithBing=function(){window.open("https://www.bing.com/search?q="+this.RandomFood.ItemName,"_blank")},t.$inject=["foodDataService"],t}();angular.module("homeModule").controller("home.controllers.homeController",o)}(o=t.home||(t.home={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o,e,n){this.listDataService=t,this.foodDataService=e,this.$location=n,this.getSingleList(o.id),this.getAllFoodFromList(o.id)}return t.prototype.setToUpdate=function(t){this.currentFood=t},t.prototype.showRandomFoodFromList=function(){if(this.allFoods=this.allFoodsBackup,this.allFoods.length>1){var t=[],o=Math.floor(Math.random()*this.allFoods.length);t.push(this.allFoods[o]),this.allFoods=t}},t.prototype.togglepublic=function(t){var o=this;t.IsPublic=!t.IsPublic,this.foodDataService.UpdateFood(t.Id,t).then(function(t){o.getAllFoodFromList(o.currentList.Id)},function(t){console.log(t)})},t.prototype.deleteFood=function(t){var o=this;this.foodDataService.DeleteFood(t).then(function(t){o.getAllFoodFromList(o.currentList.Id)},function(t){console.log(t)})},t.prototype.deleteList=function(){var t=this;this.listDataService.DeleteList(this.currentList.Id).then(function(o){t.$location.path("/lists")},function(t){console.log(t)})},t.prototype.addFood=function(){var t=this;this.currentFood.Id?(console.log("update"),this.foodDataService.UpdateFood(this.currentFood.Id,this.currentFood).then(function(o){t.currentFood=null,t.getAllFoodFromList(t.currentList.Id)},function(t){console.log(t)})):(console.log("insert"),this.currentFood.FoodListId=this.currentList.Id,this.foodDataService.AddFood(this.currentFood).then(function(o){t.currentFood=null,t.getAllFoodFromList(t.currentList.Id)},function(t){console.log(t)}))},t.prototype.getAllFoodFromList=function(t){var o=this;this.listDataService.GetAllFoodsFromList(t).then(function(t){o.allFoods=t.data,o.allFoodsBackup=t.data;for(var e=0;e<o.allFoods.length;e++){var n={Name:o.allFoods[e].ItemName+" ",Avatar:null};o.allFoods[e].Avatar=n}console.log("this.allFoods: "+o.allFoods)},function(t){console.log(t)})},t.prototype.inviteUser=function(){this.listDataService.InviteUser(this.currentList.Id,this.userToInvite).then(function(t){console.log(t)},function(t){console.log(t)})},t.prototype.getSingleList=function(t){var o=this;this.listDataService.GetSingleList(t).then(function(t){o.currentList=t.data},function(t){console.log(t)})},t.$inject=["listDataService","$stateParams","foodDataService","$location"],t}();angular.module("listsModule").controller("lists.controllers.listDetailsController",o)}(o=t.lists||(t.lists={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t){this.listDataService=t,this.getAllLists(),this.getAllSharedLists()}return t.prototype.addList=function(){var t=this;this.listDataService.AddList(this.newList).then(function(o){t.newList=null,t.getAllLists()},function(t){console.log(t)})},t.prototype.getAllLists=function(){var t=this;this.listDataService.GetAllLists().then(function(o){t.allLists=o.data,console.log(t.allLists)},function(t){console.log(t)})},t.prototype.getAllSharedLists=function(){var t=this;this.listDataService.GetAllSharedLists().then(function(o){t.allSharedLists=o.data,console.log(t.allSharedLists)},function(t){console.log(t)})},t.$inject=["listDataService"],t}();angular.module("listsModule").controller("lists.controllers.listController",o)}(o=t.lists||(t.lists={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o){this.$http=t,this.appSettings=o,this.actionUrl=this.appSettings.serverPath+"api/foods/"}return t.prototype.DeleteFood=function(t){return this.$http["delete"](this.actionUrl+t)},t.prototype.UpdateFood=function(t,o){return this.$http.put(this.actionUrl+t,o)},t.prototype.AddFood=function(t){return this.$http.post(this.actionUrl,t)},t.prototype.GetRandomFood=function(){return this.$http.get(this.actionUrl+"getrandomfood")},t.$inject=["$http","appSettings"],t}();t.FoodDataService=o,angular.module("listsModule").service("foodDataService",o)}(o=t.lists||(t.lists={}))}(app||(app={}));var app;!function(t){var o;!function(t){var o=function(){function t(t,o){this.$http=t,this.appSettings=o,this.actionUrl=this.appSettings.serverPath+"api/foodlists/"}return t.prototype.GetAllLists=function(){return this.$http.get(this.actionUrl)},t.prototype.GetAllSharedLists=function(){return this.$http.get(this.appSettings.serverPath+"api/SharedFoodLists")},t.prototype.GetSingleList=function(t){return this.$http.get(this.actionUrl+t)},t.prototype.GetAllFoodsFromList=function(t){return this.$http.get(this.actionUrl+t+"/foods")},t.prototype.AddList=function(t){return this.$http.post(this.actionUrl,t)},t.prototype.InviteUser=function(t,o){return this.$http.get(this.appSettings.serverPath+"api/SharedFoodLists/"+t+"/"+o+"/")},t.prototype.DeleteList=function(t){return this.$http["delete"](this.actionUrl+t)},t.$inject=["$http","appSettings"],t}();t.ListDataService=o,angular.module("listsModule").service("listDataService",o)}(o=t.lists||(t.lists={}))}(app||(app={}));